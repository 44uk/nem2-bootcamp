# nem1からnem2で変わった仕様

主な仕様の変更点を紹介します。


## ネームスペースとモザイク

`nem1`では、`foo.bar`のような3階層までのネームスペースを取得し、それぞれのネームスペース配下に`baz`というモザイクを`foo.bar:baz`として定義することができました。

`nem2`では、ネームスペースは、アドレスまたはモザイクに対してのエイリアスとして機能するようになります。

モザイクはネームスペース配下にではなく、独立して存在することとなり、16進数の`MosaicId`が割り当てられます。

ゆえにモザイクの作成だけでは`foo.bar:baz`のような名前を持たないことになります。

このモザイクに対してネームスペースをリンクすることで、`foo.bar`という名前でモザイクを特定できるようになります。

IPアドレスに対してドメイン名を割り当てるようなイメージです。

この変更はネームスペースとモザイクの命名などに影響があるため、旧仕様に則ったシステムを構築している場合は、仕様を大きく変更しないといけない可能性があります。

具体的には、ネームスペースが最大3階層という制限は同等ですが、その下にモザイクが作れなくなります。

`foo.bar.baz:qux`というモザイクを使っていた場合は、変わりに`foo.bar.baz-qux`のようなネームスペースでリンクさせるなど、アプリケーションの仕様を変える必要があります。


## 特別な存在としてのXEMの廃止

`nem1`では、モザイクと`xem`は区別され、アカウントの残高には`amount`として`xem`の残高が表現されていました。

`nem2`では、そのような表現がなくなり、全てモザイクで表現されるようになりました。

`nem1`でも`xem`をモザイクとして保有を表現していたり、モザイクとして送受信できますが、その方式だけに統一されました。


## APIのレスポンス

`nem1`では、トランザクションの結果レスポンスは同期的だったので、結果はリクエストと対になっていました。

`nem2`では、リクエストがAPIサーバに届いたかどうかのレスポンスしか返さず、内容は常にOKを返却します。

モニタリングで実施したように、WebSocketで状態チャンネルに接続し、流れてくる結果で取得する必要があります。

この仕様変更の解決に関して`nem2-camel`という同期的にレスポンスを返す中間サーバのプロジェクトがあります。

- [nemtech/nem2\-camel: A component to turn the asynchronous transaction announcement into synchronous\.](https://github.com/nemtech/nem2-camel)
